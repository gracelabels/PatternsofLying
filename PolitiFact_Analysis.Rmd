---
title: "PolitiFact Analysis"
author: "Sofia Bliss-Carrascoas"
date: "9/28/2022"
output:
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: inline
---

```{r load packages, warning=FALSE, message=FALSE, echo = FALSE}
library(tidyverse)
library(knitr)
```

```{r color scale and ordering, warning=FALSE, message=FALSE, echo = FALSE }
pf_mega <- read_csv("pf_mega_location.csv")

truenesscolors = c("#FF0000", "#FF872C", "#FAB733", "#FDE64B", "#ACB334", "#69B34C")

pf_mega$textualRating <- factor(pf_mega$textualRating, 
                              levels = c("Pants on Fire", 
                                         "False", 
                                         "Mostly False", 
                                         "Half True", 
                                         "Mostly True", 
                                         "True"))
```

```{r fix tagging error,  warning=FALSE, message=FALSE, echo = FALSE}
pf_mega$`Government Operations`[pf_mega$...1 == "3990"] <- "TRUE"
```

```{r plot of party counts,  warning=FALSE, message=FALSE, echo = FALSE}
ggplot(pf_mega, aes(x = textualRating, fill = claimant_party)) +
 geom_bar(position = "fill") +
  scale_fill_manual( values = c("blue2", "red3")) +
  labs(title = "Ratings Proportions by Party",
       x = "Rating",
       y = "Proportion",
       fill = "Party of Claimant")

ggplot(pf_mega, aes(x = textualRating, fill = claimant_party)) +
 geom_bar() +
  scale_fill_manual(values = c("blue2", "red3")) +
  labs(title = "Ratings Counts by Party",
       x = "Rating",
       y = "Total Claims",
       fill = "Party of Claimant")
```

```{r severity graph,  warning=FALSE, message=FALSE, echo = FALSE}
ggplot(pf_mega, aes(x = claimant_party, fill = textualRating)) +
         geom_bar(position = "fill") +
  labs(title = "Percentage Rating by Party",
       x = "Claims by Party",
       fill = "Rating", y = "Percentage") +
  scale_fill_manual(values = truenesscolors)

dems <- pf_mega %>%
  filter(claimant_party == "Democratic")
dems %>%
  group_by(textualRating) %>%
  count() %>%
  summarize(prop = n/nrow(dems)) %>%
  kable(digits = 4, caption = "Proportion of Democratic Truthfulness")

reps <- pf_mega %>%
  filter(claimant_party == "Republican")
reps %>%
  group_by(textualRating) %>%
  count() %>%
  summarize(prop = n/nrow(dems)) %>%
  kable(digits = 4, caption = "Proportion of Republican Truthfulness")
```

```{r pivot table,  warning=FALSE, message=FALSE, echo = FALSE}
#pf_mega %>%
  #count(claimant_party, textualRating) %>%
  #pivot_wider(id_cols = c(claimant_party,
                         # textualRating),
              #names_from = textualRating,
             # values_from = n,
              #values_fill = 0)%>%
  #kable(caption = "Fact-checks per rating by Party")
```

```{r, subject tag table,  warning=FALSE, message=FALSE, echo = FALSE}
binarymacro <- pf_mega %>%
  mutate(Fear = case_when(Fear == TRUE ~ 1,
                          Fear == FALSE ~ 0)) %>%
  mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
  mutate(`Self/Personal Record` = case_when(`Self/Personal Record` == TRUE ~ 1, 
                                            `Self/Personal Record` == FALSE ~ 0)) %>%
  mutate(`Opponent/Opponent's Record` = case_when(`Opponent/Opponent's Record` == TRUE ~ 1, 
                                                  `Opponent/Opponent's Record` == FALSE ~ 0)) %>%
  select(Fear, Legislation, `Self/Personal Record`, `Opponent/Opponent's Record`, claimant_party) %>%
  filter(!is.na(Fear)) 

macro_tibble <- binarymacro %>%
  group_by(claimant_party) %>%
  summarize(Fear = sum(Fear), Legislation = sum(Legislation), "Self/Personal Record" = sum(`Self/Personal Record`), "Opponent/Opponent's Record" = sum(`Opponent/Opponent's Record`))

macro_tibble <- t(macro_tibble)

macro_tibble %>% kable()
```

```{r}
pf_mega %>% colnames()

binarymicro <- pf_mega %>%
  mutate(`National and State Macroeconomic Issues` = 
           case_when(`National and State Macroeconomic Issues` == TRUE ~ 1,
                    `National and State Macroeconomic Issues` == FALSE ~ 0)) %>%
  mutate(`Economic Well-Being and Domestic Commerce` = 
           case_when(`Economic Well-Being and Domestic Commerce` == TRUE ~ 1,
           `Economic Well-Being and Domestic Commerce` == FALSE ~ 0)) %>%
   mutate(`Labor and Employment` = case_when(`Labor and Employment` == TRUE ~ 1,
           `Labor and Employment` == FALSE ~ 0)) %>%
   mutate(`Foreign Trade` = case_when(`Foreign Trade` == TRUE ~ 1,
          `Foreign Trade` == FALSE ~ 0)) %>%
   mutate(`Taxes` = case_when(`Taxes` == TRUE ~ 1,
          `Taxes` == FALSE ~ 0)) %>%
   mutate(`Civil Rights, Minority Issues, and Civil Liberties` = 
        case_when(`Civil Rights, Minority Issues, and Civil Liberties` == TRUE ~ 1,
        `Civil Rights, Minority Issues, and Civil Liberties` == FALSE ~ 0)) %>%
   mutate(`Immigration and Refugee Issues` = case_when(`Immigration and Refugee Issues` == TRUE ~ 1,
          `Immigration and Refugee Issues` == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>% 
  mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
   mutate(Legislation = case_when(Legislation == TRUE ~ 1,
                                 Legislation == FALSE ~ 0)) %>%
  
  mutate(`Self/Personal Record` = case_when(`Self/Personal Record` == TRUE ~ 1, 
                                            `Self/Personal Record` == FALSE ~ 0)) %>%
  mutate(`Opponent/Opponent's Record` = case_when(`Opponent/Opponent's Record` == TRUE ~ 1, 
                                                  `Opponent/Opponent's Record` == FALSE ~ 0)) %>%
  select(Fear, Legislation, `Self/Personal Record`, `Opponent/Opponent's Record`, claimant_party) %>%
  filter(!is.na(Fear)) 

micro_tibble <- binarymicro %>%
  group_by(claimant_party) %>%
  summarize( National and State Macroeconomic Issues = sum(`National and State Macroeconomic Issues`),
             Economic Well-Being and Domestic Commerce = sum(`Economic Well-Being and Domestic Commerce`),
             `Labor and Employment` = sum(`Labor and Employment`),`Foreign Trade` = sum(`Foreign Trade`))

micro_tibble <- t(micro_tibble)

micro_tibble %>% kable()
```



```{r}
microtibble
```

